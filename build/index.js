var t,e,s,n,i={d:(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},r={};i.d(r,{pM:()=>t,dw:()=>g,lZ:()=>n,Zt:()=>K,A1:()=>f,Uz:()=>e,s3:()=>a,KK:()=>h,w3:()=>s,A4:()=>w,Z5:()=>x,gX:()=>m,I9:()=>u,qE:()=>o,Dz:()=>y,X_:()=>d,gW:()=>_,DY:()=>c,IO:()=>l}),function(t){let e,s;!function(t){t.addAll=function(t,e){for(const s of e)t.push(s);return t},t.removeAll=function(t,e){const s=new globalThis.Set(e);if(!s.size)return t;for(let e=t.length-1;e>=0;e--)s.has(t[e])&&t.splice(e,1);return t}}(e=t.Array||(t.Array={})),function(t){t.addAll=function(t,e){for(const s of e)t.add(s);return t},t.removeAll=function(t,e){for(const s of e)t.delete(s);return t}}(s=t.Set||(t.Set={}))}(t||(t={})),function(t){t.Unidentified="Unidentified",t.Pause="Pause",t.Backspace="Backspace",t.Tab="Tab",t.NumLock="NumLock",t.Enter="Enter",t.ShiftLeft="ShiftLeft",t.ShiftRight="ShiftRight",t.ControlLeft="ControlLeft",t.ControlRight="ControlRight",t.AltLeft="AltLeft",t.AltRight="AltRight",t.CapsLock="CapsLock",t.Lang1="Lang1",t.Lang2="Lang2",t.Escape="Escape",t.Space="Space",t.Numpad9="Numpad9",t.Numpad3="Numpad3",t.Numpad1="Numpad1",t.Numpad7="Numpad7",t.Left="ArrowLeft",t.Up="ArrowUp",t.Right="ArrowRight",t.Down="ArrowDown",t.F13="F13",t.Numpad0="Numpad0",t.NumpadDecimal="NumpadDecimal",t.Digit0="Digit0",t.Digit1="Digit1",t.Digit2="Digit2",t.Digit3="Digit3",t.Digit4="Digit4",t.Digit5="Digit5",t.Digit6="Digit6",t.Digit7="Digit7",t.Digit8="Digit8",t.Digit9="Digit9",t.Period="Period",t.Semicolon="Semicolon",t.Backquote="Backquote",t.Equal="Equal",t.Minus="Minus",t.A="KeyA",t.B="KeyB",t.C="KeyC",t.D="KeyD",t.E="KeyE",t.F="KeyF",t.G="KeyG",t.H="KeyH",t.I="KeyI",t.J="KeyJ",t.K="KeyK",t.L="KeyL",t.M="KeyM",t.N="KeyN",t.O="KeyO",t.P="KeyP",t.Q="KeyQ",t.R="KeyR",t.S="KeyS",t.T="KeyT",t.U="KeyU",t.V="KeyV",t.W="KeyW",t.X="KeyX",t.Y="KeyY",t.Z="KeyZ",t.MetaLeft="MetaLeft",t.MetaRight="MetaRight",t.ContextMenu="ContextMenu",t.NumpadMultiply="NumpadMultiply",t.NumpadAdd="NumpadAdd",t.NumpadSubtract="NumpadSubtract",t.NumpadDivide="NumpadDivide",t.F1="F1",t.F2="F2",t.F3="F3",t.F4="F4",t.F5="F5",t.F6="F6",t.F7="F7",t.F8="F8",t.F9="F9",t.F10="F10",t.F11="F11",t.F12="F12",t.F14="F14",t.F15="F15",t.F16="F16",t.F17="F17",t.F18="F18",t.F19="F19",t.F20="F20",t.F21="F21",t.F22="F22",t.F23="F23",t.F24="F24",t.F25="F25",t.F26="F26",t.F27="F27",t.F28="F28",t.F29="F29",t.F30="F30",t.F31="F31",t.F32="F32",t.ScrollLock="ScrollLock",t.BracketLeft="BracketLeft",t.BracketRight="BracketRight",t.Backslash="Backslash",t.Quote="Quote",t.MediaTrackNext="MediaTrackNext",t.MediaTrackPrevious="MediaTrackPrevious",t.VolumeMute="VolumeMute",t.VolumeDown="VolumeDown",t.VolumeUp="VolumeUp",t.Comma="Comma",t.Slash="Slash",t.IntlBackslash="IntlBackslash",t.IntlRo="IntlRo",t.NumpadComma="NumpadComma",t.OSLeft="OSLeft",t.WakeUp="WakeUp"}(e||(e={}));class a{constructor(){this._newPressedKeys=new Set,this._newReleasedKeys=new Set,this._keys=Object.values(e),this._downKeys=new Set,this._upKeys=new Set,this._pressedKeys=new Set,this._releasedKeys=new Set,this._newTypedString="",this._typedString="",K._ensureLaunched();const t=K.canvas;t.addEventListener("keydown",(t=>this._onKeyDown(t))),t.addEventListener("keyup",(t=>this._onKeyUp(t)))}static get typedString(){return this._self._typedString}static get downKeys(){return this._self._downKeys}static get upKeys(){return this._self._upKeys}static get pressedKeys(){return this._self._pressedKeys}static get releasedKeys(){return this._self._releasedKeys}static isKeyDown(t){return this._self._downKeys.has(e[t])}static isKeyUp(t){return this._self._upKeys.has(e[t])}static isKeyPressed(t){return this._self._pressedKeys.has(e[t])}static isKeyReleased(t){return this._self._releasedKeys.has(e[t])}static get _self(){return this._instance??(this._instance=new this)}_update(){K.focused?(this._updateTypedString(),this._updatePressedKeys(),this._updateDownKeys(),this._updateReleasedKeys(),this._updateUpKeys()):this._reset()}_onKeyDown(t){const e=t.code;this._keys.includes(e)&&this._newPressedKeys.add(e),1===t.key.length&&(this._newTypedString+=t.key)}_onKeyUp(t){const e=t.code;this._keys.includes(e)&&this._newReleasedKeys.add(e)}_updateTypedString(){this._typedString=this._newTypedString,this._newTypedString=""}_updateDownKeys(){t.Set.addAll(this._downKeys,this._newPressedKeys),this._newPressedKeys.clear()}_updateUpKeys(){this._upKeys.clear(),t.Set.addAll(this._upKeys,this._keys),t.Set.removeAll(this._upKeys,this._downKeys)}_updatePressedKeys(){this._pressedKeys.clear(),t.Set.addAll(this._pressedKeys,this._newPressedKeys),t.Set.removeAll(this._pressedKeys,this._downKeys)}_updateReleasedKeys(){this._releasedKeys.clear(),t.Set.addAll(this._releasedKeys,this._newReleasedKeys),this._newReleasedKeys.clear(),t.Set.removeAll(this._downKeys,this._releasedKeys)}_reset(){this._newTypedString="",this._typedString="",this._newPressedKeys.clear(),this._downKeys.clear(),this._newReleasedKeys.clear(),this._releasedKeys.clear(),this._updateUpKeys()}}a._instance=null,function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(s||(s={}));class h{constructor(){this._newPressedButtons=new Set,this._newReleasedButtons=new Set,this._buttons=Object.values(s),this._downButtons=new Set,this._upButtons=new Set,this._pressedButtons=new Set,this._releasedButtons=new Set,K._ensureLaunched();const t=K.canvas;t.addEventListener("mousedown",(t=>this._onMouseDown(t))),t.addEventListener("mouseup",(t=>this._onMouseUp(t)))}static get downButtons(){return this._self._downButtons}static get upButtons(){return this._self._upButtons}static get pressedButtons(){return this._self._pressedButtons}static get releasedButtons(){return this._self._releasedButtons}static isButtonDown(t){return this._self._downButtons.has(s[t])}static isButtonUp(t){return this._self._upButtons.has(s[t])}static isButtonPressed(t){return this._self._pressedButtons.has(s[t])}static isButtonReleased(t){return this._self._releasedButtons.has(s[t])}static get _self(){return this._instance??(this._instance=new this)}_update(){K.focused?(this._updatePressedButtons(),this._updateDownButtons(),this._updateReleasedButtons(),this._updateUpButtons()):this._reset()}_onMouseDown(t){const e=t.button;this._buttons.includes(e)&&this._newPressedButtons.add(e)}_onMouseUp(t){const e=t.button;this._buttons.includes(e)&&this._newReleasedButtons.add(e)}_updateDownButtons(){t.Set.addAll(this._downButtons,this._newPressedButtons),this._newPressedButtons.clear()}_updateUpButtons(){this._upButtons.clear(),t.Set.addAll(this._upButtons,this._buttons),t.Set.removeAll(this._upButtons,this._downButtons)}_updatePressedButtons(){this._pressedButtons.clear(),t.Set.addAll(this._pressedButtons,this._newPressedButtons),t.Set.removeAll(this._pressedButtons,this._downButtons)}_updateReleasedButtons(){this._releasedButtons.clear(),t.Set.addAll(this._releasedButtons,this._newReleasedButtons),this._newReleasedButtons.clear(),t.Set.removeAll(this._downButtons,this._releasedButtons)}_reset(){this._newPressedButtons.clear(),this._downButtons.clear(),this._newReleasedButtons.clear(),this._releasedButtons.clear(),this._updateUpButtons()}}function o(t,e,s){return Math.min(Math.max(t,e),s)}h._instance=null;class u{constructor(t=0,e=t){this.x=t,this.y=e}static extractValue(t){return"number"==typeof t?new u(t):this._extractArray(t)}static _extractArray(t){return Array.isArray(t)?new u(t[0],t[1]):t}plus(t){if("number"==typeof t)return new u(this.x+t,this.y+t);const e=u._extractArray(t);return new u(this.x+e.x,this.y+e.y)}minus(t){if("number"==typeof t)return new u(this.x-t,this.y-t);const e=u._extractArray(t);return new u(this.x-e.x,this.y-e.y)}times(t){if("number"==typeof t)return new u(this.x*t,this.y*t);const e=u._extractArray(t);return new u(this.x*e.x,this.y*e.y)}div(t){if("number"==typeof t)return 0===t?u.ZERO:new u(this.x/t,this.y/t);const e=u._extractArray(t);return new u(0===e.x?0:this.x/e.x,0===e.y?0:this.y/e.y)}equals(t){if("number"==typeof t)return this.x===t&&this.y===t;const e=u._extractArray(t);return this.x===e.x&&this.y===e.y}clamp(t,e){let s,n,i,r;if("number"==typeof t)s=t,i=t;else{const e=u._extractArray(t);s=e.x,i=e.y}if("number"==typeof e)n=e,r=e;else{const t=u._extractArray(e);n=t.x,r=t.y}return new u(o(this.x,s,n),o(this.y,i,r))}clampX(t,e){return this.x<t?new u(t,this.y):this.x>e?new u(e,this.y):this}clampY(t,e){return this.y<t?new u(this.x,t):this.y>e?new u(this.x,e):this}distanceTo(t){const e=t.x-this.x,s=t.y-this.y;return Math.sqrt(e*e+s*s)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}rotate(t,e){const s=t*Math.PI/180,n=Math.cos(s),i=Math.sin(s),r=this.x-e.x,a=this.y-e.y,h=r*i+a*n;return new u(r*n-a*i+e.x,h+e.y)}angleBetween(t){const e=this.length()*t.length();return 0===e?0:Math.acos(this.dot(t)/e)}reflect(t){const e=this.dot(t);return new u(this.x-2*e*t.x,this.y-2*e*t.y)}lerp(t,e){const s=Math.max(0,Math.min(1,e));return new u(this.x+(t.x-this.x)*s,this.y+(t.y-this.y)*s)}slerp(t,e){const s=this.angleBetween(t),n=Math.cos(s*e),i=Math.sin(s*e);return new u(this.x*n+t.x*i,this.y*n+t.y*i)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}round(){return new u(Math.round(this.x),Math.round(this.y))}abs(){return new u(Math.abs(this.x),Math.abs(this.y))}normalize(){const t=this.length();return 0===t?u.ZERO:new u(this.x/t,this.y/t)}}function c(t,e,s){return`rgb(${o(t,0,255)}, ${o(e,0,255)}, ${o(s,0,255)})`}function l(t,e,s,n){return`rgba(${o(t,0,255)}, ${o(e,0,255)}, ${o(s,0,255)}, ${o(n,0,1)})`}function d(t,e,s){return`hsl(${o(t,0,360)}, ${o(e,0,100)}%, ${o(s,0,100)}%)`}function _(t,e,s,n){return`hsla(${o(t,0,360)}, ${o(e,0,100)}%, ${o(s,0,100)}%, ${o(n,0,1)})`}function y(t){if(t.startsWith("#")){let e=t.replace("#","");if(3===e.length&&(e=e.split("").map((t=>t+t)).join("")),6===e.length||8===e.length)return{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?parseInt(e.substring(6,8),16)/255:1}}const e=/^rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)$/.exec(t);if(e)return{r:o(parseInt(e[1]),0,255),g:o(parseInt(e[2]),0,255),b:o(parseInt(e[3]),0,255),a:1};const s=/^rgba\((\d{1,3}), (\d{1,3}), (\d{1,3}), ([0-1]?\.\d+|[0-9]{1,3})\)$/.exec(t);if(s)return{r:o(parseInt(s[1]),0,255),g:o(parseInt(s[2]),0,255),b:o(parseInt(s[3]),0,255),a:o(parseFloat(s[4]),0,1)};const n=/^hsl\((\d{1,3}), (\d{1,3})%, (\d{1,3})%\)$/.exec(t);if(n)return{...p(o(parseInt(n[1]),0,360),o(parseInt(n[2]),0,100),o(parseInt(n[3]),0,100)),a:1};const i=/^hsla\((\d{1,3}), (\d{1,3})%, (\d{1,3})%, ([0-1]?\.\d+|[0-9]{1,3})\)$/.exec(t);if(i){const t=o(parseInt(i[1]),0,360),e=o(parseInt(i[2]),0,100),s=o(parseInt(i[3]),0,100),n=o(parseFloat(i[4]),0,1);return{...p(t,e,s),a:n}}return{r:0,g:0,b:0,a:0}}function p(t,e,s){const n=(1-Math.abs(2*s/100-1))*(e/100),i=n*(1-Math.abs(t/60%2-1)),r=s/100-n/2;let a=0,h=0,o=0;return t>=0&&t<60?(a=n,h=i,o=0):t>=60&&t<120?(a=i,h=n,o=0):t>=120&&t<180?(a=0,h=n,o=i):t>=180&&t<240?(a=0,h=i,o=n):t>=240&&t<300?(a=i,h=0,o=n):t>=300&&t<360&&(a=n,h=0,o=i),{r:Math.round(255*(a+r)),g:Math.round(255*(h+r)),b:Math.round(255*(o+r))}}u.ZERO=new u,u.UP=new u(0,-1),u.DOWN=new u(0,1),u.LEFT=new u(-1,0),u.RIGHT=new u(1,0);class f{constructor(t){this._context=t}get width(){return this._context.canvas.width}get height(){return this._context.canvas.height}clear(t){this._context.fillStyle=t,this._context.fillRect(0,0,this.width,this.height)}}class w{constructor(){K._ensureLaunched(),this._buffer=new OffscreenCanvas(K.width,K.height),this._context=K.canvas.getContext("2d"),this._graphics=new f(this._buffer.getContext("2d"))}static get graphics(){return this._self._graphics}static get _self(){return this._instance??(this._instance=new this)}_update(){const t=K.screenSize,e=K.scaleFactor,s=K.size.times(e),n=t.minus(s).div(2);this._context.fillStyle="#000",this._context.fillRect(0,0,t.x,t.y),this._context.drawImage(this._buffer,n.x,n.y,s.x,s.y)}}w._instance=null,function(t){t[t.Nanoseconds=1]="Nanoseconds",t[t.Microseconds=1e3]="Microseconds",t[t.Milliseconds=1e6]="Milliseconds",t[t.Seconds=1e9]="Seconds",t[t.Minutes=6e10]="Minutes",t[t.Hours=36e11]="Hours",t[t.Days=864e11]="Days"}(n||(n={}));class g{constructor(t,e="Nanoseconds"){this._nanoseconds=t*n[e]}static fromNanoseconds(t){return new g(t,"Nanoseconds")}static fromMicroseconds(t){return new g(t,"Microseconds")}static fromMilliseconds(t){return new g(t,"Milliseconds")}static fromSeconds(t){return new g(t,"Seconds")}static fromMinutes(t){return new g(t,"Minutes")}static fromHours(t){return new g(t,"Hours")}static fromDays(t){return new g(t,"Days")}to(t){return this._nanoseconds/n[t]}get nanoseconds(){return this.to("Nanoseconds")}get microseconds(){return this.to("Microseconds")}get milliseconds(){return this.to("Milliseconds")}get seconds(){return this.to("Seconds")}get minutes(){return this.to("Minutes")}get hours(){return this.to("Hours")}get days(){return this.to("Days")}add(t){return new g(this._nanoseconds+t._nanoseconds)}subtract(t){return new g(this._nanoseconds-t._nanoseconds)}toString(){const t=Math.floor(this.days),e=Math.floor(this.hours%24),s=Math.floor(this.minutes%60),n=Math.floor(this.seconds%60),i=Math.floor(this.milliseconds%1e3),r=[];return t&&r.push(`${t}d`),e&&r.push(`${e}h`),s&&r.push(`${s}m`),n&&r.push(`${n}s`),i&&r.push(`${i}ms`),r.length>0?r.join(" "):"0ms"}}class m{constructor(){this._launchTime=performance.now(),this._fixedDelta=1/60,this._startTime=this._launchTime,this._lastFrameTime=0,this._frameCount=0,this._delta=0,this._averageFPS=0,K._ensureLaunched()}static get elapsed(){return g.fromMilliseconds(performance.now()-this._self._launchTime)}static get delta(){return this._self._delta}static get fixedDelta(){return this._self._fixedDelta}static get averageFPS(){return this._self._averageFPS}static get currentFPS(){const t=this._self;return t._delta<=0?0:1/t._delta}static get _self(){return this._instance??(this._instance=new this)}_update(){const t=performance.now()-this._startTime;this._frameCount++,this._delta=(t-this._lastFrameTime)/1e3;const e=t/1e3;this._averageFPS=0===e?0:this._frameCount/e,this._lastFrameTime=t}_restart(){this._startTime=performance.now(),this._lastFrameTime=0,this._frameCount=0,this._delta=0,this._averageFPS=0}}m._instance=null;class K{constructor(){this._time=null,this._keyboard=null,this._mouse=null,this._renderer=null,this._canvas=null,this._scene=null,this._size=null,this._shouldResize=!1,K._ensureLaunched()}static get focused(){return document.activeElement===this._self._canvas}static get canvas(){return this._self._canvas}static get scene(){return this._self._scene}static set scene(t){this._self._scene=t}static get width(){return this._self._size.x}static get height(){return this._self._size.y}static get size(){return this._self._size}static get screenWidth(){return this._self._canvas.width}static get screenHeight(){return this._self._canvas.height}static get screenSize(){const t=this._self;return new u(t._canvas.width,t._canvas.height)}static get scaleFactor(){const t=this._self;return Math.min(t._canvas.width/t._size.x,t._canvas.height/t._size.y)}static launch(t){this._ensureNotLaunched(),this._launched=!0,this._self._launch(t)}static get _self(){return this._instance??(this._instance=new this)}static _ensureNotLaunched(){if(this._launched)throw new Error("Game has already been launched")}static _ensureLaunched(){if(!this._launched)throw new Error("Game has not been launched")}_launch(t){this._scene=t.scene,this._canvas=t.canvas,this._size=new u(t.width??800,t.height??600),this._initialize(),this._start()}_initialize(){this._initializeCanvas(),this._time=m._self,this._keyboard=a._self,this._mouse=h._self,this._renderer=w._self}_initializeCanvas(){this._resizeCanvas(),new ResizeObserver((()=>this._shouldResize=!0)).observe(this._canvas.parentElement),this._canvas.tabIndex=0,this._canvas.oncontextmenu=()=>!1,this._canvas.focus()}_start(){this._scene._initialize().then((()=>this._frame()))}_update(){const t=this._scene;return this._time._update(),this._keyboard._update(),this._mouse._update(),t.update(),this._handleResizing(),this._renderer._update(),this._nextFrame(t)}_nextFrame(t){return this._scene===t?this._frame():(t.stop(),this._scene._initialize().then((()=>(this._time._restart(),this._frame()))))}_frame(){return new Promise((t=>requestAnimationFrame((()=>this._update().then(t)))))}_handleResizing(){this._shouldResize&&(this._shouldResize=!1,this._resizeCanvas())}_resizeCanvas(){const{width:t,height:e}=this._canvas.parentElement.getBoundingClientRect();this._canvas.width=t,this._canvas.height=e}}K._instance=null,K._launched=!1;class x{constructor(){this._initialized=!1}async _initialize(){return this._initialized||(this._initialized=!0,await this.initialize()),this.start()}}var F=r.pM,S=r.dw,B=r.lZ,M=r.Zt,v=r.A1,b=r.Uz,D=r.s3,R=r.KK,A=r.w3,L=r.A4,z=r.Z5,N=r.gX,P=r.I9,k=r.qE,C=r.Dz,I=r.X_,T=r.gW,U=r.DY,E=r.IO;export{F as Collection,S as Duration,B as DurationUnit,M as Game,v as Graphics,b as Key,D as Keyboard,R as Mouse,A as MouseButton,L as Renderer,z as Scene,N as Time,P as Vector2,k as clamp,C as extractColor,I as hslColor,T as hslaColor,U as rgbColor,E as rgbaColor};