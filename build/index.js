var e,t,s,i,n={d:(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},a={};n.d(a,{pM:()=>e,dw:()=>h,lZ:()=>i,Zt:()=>d,Uz:()=>t,s3:()=>r,KK:()=>o,w3:()=>s,Z5:()=>_,gX:()=>u}),function(e){let t,s;!function(e){e.addAll=function(e,t){for(const s of t)e.push(s);return e},e.removeAll=function(e,t){const s=new globalThis.Set(t);if(!s.size)return e;for(let t=e.length-1;t>=0;t--)s.has(e[t])&&e.splice(t,1);return e}}(t=e.Array||(e.Array={})),function(e){e.addAll=function(e,t){for(const s of t)e.add(s);return e},e.removeAll=function(e,t){for(const s of t)e.delete(s);return e}}(s=e.Set||(e.Set={}))}(e||(e={})),function(e){e.Unidentified="Unidentified",e.Pause="Pause",e.Backspace="Backspace",e.Tab="Tab",e.NumLock="NumLock",e.Enter="Enter",e.ShiftLeft="ShiftLeft",e.ShiftRight="ShiftRight",e.ControlLeft="ControlLeft",e.ControlRight="ControlRight",e.AltLeft="AltLeft",e.AltRight="AltRight",e.CapsLock="CapsLock",e.Lang1="Lang1",e.Lang2="Lang2",e.Escape="Escape",e.Space="Space",e.Numpad9="Numpad9",e.Numpad3="Numpad3",e.Numpad1="Numpad1",e.Numpad7="Numpad7",e.Left="ArrowLeft",e.Up="ArrowUp",e.Right="ArrowRight",e.Down="ArrowDown",e.F13="F13",e.Numpad0="Numpad0",e.NumpadDecimal="NumpadDecimal",e.Digit0="Digit0",e.Digit1="Digit1",e.Digit2="Digit2",e.Digit3="Digit3",e.Digit4="Digit4",e.Digit5="Digit5",e.Digit6="Digit6",e.Digit7="Digit7",e.Digit8="Digit8",e.Digit9="Digit9",e.Period="Period",e.Semicolon="Semicolon",e.Backquote="Backquote",e.Equal="Equal",e.Minus="Minus",e.A="KeyA",e.B="KeyB",e.C="KeyC",e.D="KeyD",e.E="KeyE",e.F="KeyF",e.G="KeyG",e.H="KeyH",e.I="KeyI",e.J="KeyJ",e.K="KeyK",e.L="KeyL",e.M="KeyM",e.N="KeyN",e.O="KeyO",e.P="KeyP",e.Q="KeyQ",e.R="KeyR",e.S="KeyS",e.T="KeyT",e.U="KeyU",e.V="KeyV",e.W="KeyW",e.X="KeyX",e.Y="KeyY",e.Z="KeyZ",e.MetaLeft="MetaLeft",e.MetaRight="MetaRight",e.ContextMenu="ContextMenu",e.NumpadMultiply="NumpadMultiply",e.NumpadAdd="NumpadAdd",e.NumpadSubtract="NumpadSubtract",e.NumpadDivide="NumpadDivide",e.F1="F1",e.F2="F2",e.F3="F3",e.F4="F4",e.F5="F5",e.F6="F6",e.F7="F7",e.F8="F8",e.F9="F9",e.F10="F10",e.F11="F11",e.F12="F12",e.F14="F14",e.F15="F15",e.F16="F16",e.F17="F17",e.F18="F18",e.F19="F19",e.F20="F20",e.F21="F21",e.F22="F22",e.F23="F23",e.F24="F24",e.F25="F25",e.F26="F26",e.F27="F27",e.F28="F28",e.F29="F29",e.F30="F30",e.F31="F31",e.F32="F32",e.ScrollLock="ScrollLock",e.BracketLeft="BracketLeft",e.BracketRight="BracketRight",e.Backslash="Backslash",e.Quote="Quote",e.MediaTrackNext="MediaTrackNext",e.MediaTrackPrevious="MediaTrackPrevious",e.VolumeMute="VolumeMute",e.VolumeDown="VolumeDown",e.VolumeUp="VolumeUp",e.Comma="Comma",e.Slash="Slash",e.IntlBackslash="IntlBackslash",e.IntlRo="IntlRo",e.NumpadComma="NumpadComma",e.OSLeft="OSLeft",e.WakeUp="WakeUp"}(t||(t={}));class r{constructor(){this._newPressedKeys=new Set,this._newReleasedKeys=new Set,this._keys=Object.values(t),this._downKeys=new Set,this._upKeys=new Set,this._pressedKeys=new Set,this._releasedKeys=new Set,this._newTypedString="",this._typedString="",d._ensureLaunched();const e=d.canvas;e.addEventListener("keydown",(e=>this._onKeyDown(e))),e.addEventListener("keyup",(e=>this._onKeyUp(e)))}static get typedString(){return this._self._typedString}static get downKeys(){return this._self._downKeys}static get upKeys(){return this._self._upKeys}static get pressedKeys(){return this._self._pressedKeys}static get releasedKeys(){return this._self._releasedKeys}static isKeyDown(e){return this._self._downKeys.has(t[e])}static isKeyUp(e){return this._self._upKeys.has(t[e])}static isKeyPressed(e){return this._self._pressedKeys.has(t[e])}static isKeyReleased(e){return this._self._releasedKeys.has(t[e])}static get _self(){return this._instance??(this._instance=new this)}_update(){d.focused?(this._updateTypedString(),this._updatePressedKeys(),this._updateDownKeys(),this._updateReleasedKeys(),this._updateUpKeys()):this._reset()}_onKeyDown(e){const t=e.code;this._keys.includes(t)&&this._newPressedKeys.add(t),1===e.key.length&&(this._newTypedString+=e.key)}_onKeyUp(e){const t=e.code;this._keys.includes(t)&&this._newReleasedKeys.add(t)}_updateTypedString(){this._typedString=this._newTypedString,this._newTypedString=""}_updateDownKeys(){e.Set.addAll(this._downKeys,this._newPressedKeys),this._newPressedKeys.clear()}_updateUpKeys(){this._upKeys.clear(),e.Set.addAll(this._upKeys,this._keys),e.Set.removeAll(this._upKeys,this._downKeys)}_updatePressedKeys(){this._pressedKeys.clear(),e.Set.addAll(this._pressedKeys,this._newPressedKeys),e.Set.removeAll(this._pressedKeys,this._downKeys)}_updateReleasedKeys(){this._releasedKeys.clear(),e.Set.addAll(this._releasedKeys,this._newReleasedKeys),this._newReleasedKeys.clear(),e.Set.removeAll(this._downKeys,this._releasedKeys)}_reset(){this._newTypedString="",this._typedString="",this._newPressedKeys.clear(),this._downKeys.clear(),this._newReleasedKeys.clear(),this._releasedKeys.clear(),this._updateUpKeys()}}r._instance=null,function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"}(s||(s={}));class o{constructor(){this._newPressedButtons=new Set,this._newReleasedButtons=new Set,this._buttons=Object.values(s),this._downButtons=new Set,this._upButtons=new Set,this._pressedButtons=new Set,this._releasedButtons=new Set,d._ensureLaunched();const e=d.canvas;e.addEventListener("mousedown",(e=>this._onMouseDown(e))),e.addEventListener("mouseup",(e=>this._onMouseUp(e)))}static get downButtons(){return this._self._downButtons}static get upButtons(){return this._self._upButtons}static get pressedButtons(){return this._self._pressedButtons}static get releasedButtons(){return this._self._releasedButtons}static isButtonDown(e){return this._self._downButtons.has(s[e])}static isButtonUp(e){return this._self._upButtons.has(s[e])}static isButtonPressed(e){return this._self._pressedButtons.has(s[e])}static isButtonReleased(e){return this._self._releasedButtons.has(s[e])}static get _self(){return this._instance??(this._instance=new this)}_update(){d.focused?(this._updatePressedButtons(),this._updateDownButtons(),this._updateReleasedButtons(),this._updateUpButtons()):this._reset()}_onMouseDown(e){const t=e.button;this._buttons.includes(t)&&this._newPressedButtons.add(t)}_onMouseUp(e){const t=e.button;this._buttons.includes(t)&&this._newReleasedButtons.add(t)}_updateDownButtons(){e.Set.addAll(this._downButtons,this._newPressedButtons),this._newPressedButtons.clear()}_updateUpButtons(){this._upButtons.clear(),e.Set.addAll(this._upButtons,this._buttons),e.Set.removeAll(this._upButtons,this._downButtons)}_updatePressedButtons(){this._pressedButtons.clear(),e.Set.addAll(this._pressedButtons,this._newPressedButtons),e.Set.removeAll(this._pressedButtons,this._downButtons)}_updateReleasedButtons(){this._releasedButtons.clear(),e.Set.addAll(this._releasedButtons,this._newReleasedButtons),this._newReleasedButtons.clear(),e.Set.removeAll(this._downButtons,this._releasedButtons)}_reset(){this._newPressedButtons.clear(),this._downButtons.clear(),this._newReleasedButtons.clear(),this._releasedButtons.clear(),this._updateUpButtons()}}o._instance=null,function(e){e[e.Nanoseconds=1]="Nanoseconds",e[e.Microseconds=1e3]="Microseconds",e[e.Milliseconds=1e6]="Milliseconds",e[e.Seconds=1e9]="Seconds",e[e.Minutes=6e10]="Minutes",e[e.Hours=36e11]="Hours",e[e.Days=864e11]="Days"}(i||(i={}));class h{constructor(e,t="Nanoseconds"){this._nanoseconds=e*i[t]}static fromNanoseconds(e){return new h(e,"Nanoseconds")}static fromMicroseconds(e){return new h(e,"Microseconds")}static fromMilliseconds(e){return new h(e,"Milliseconds")}static fromSeconds(e){return new h(e,"Seconds")}static fromMinutes(e){return new h(e,"Minutes")}static fromHours(e){return new h(e,"Hours")}static fromDays(e){return new h(e,"Days")}to(e){return this._nanoseconds/i[e]}get nanoseconds(){return this.to("Nanoseconds")}get microseconds(){return this.to("Microseconds")}get milliseconds(){return this.to("Milliseconds")}get seconds(){return this.to("Seconds")}get minutes(){return this.to("Minutes")}get hours(){return this.to("Hours")}get days(){return this.to("Days")}add(e){return new h(this._nanoseconds+e._nanoseconds)}subtract(e){return new h(this._nanoseconds-e._nanoseconds)}toString(){const e=Math.floor(this.days),t=Math.floor(this.hours%24),s=Math.floor(this.minutes%60),i=Math.floor(this.seconds%60),n=Math.floor(this.milliseconds%1e3),a=[];return e&&a.push(`${e}d`),t&&a.push(`${t}h`),s&&a.push(`${s}m`),i&&a.push(`${i}s`),n&&a.push(`${n}ms`),a.length>0?a.join(" "):"0ms"}}class u{constructor(){this._launchTime=performance.now(),this._fixedDelta=1/60,this._startTime=this._launchTime,this._lastFrameTime=0,this._frameCount=0,this._delta=0,this._averageFPS=0,d._ensureLaunched()}static get elapsed(){return h.fromMilliseconds(performance.now()-this._self._launchTime)}static get delta(){return this._self._delta}static get fixedDelta(){return this._self._fixedDelta}static get averageFPS(){return this._self._averageFPS}static get currentFPS(){const e=this._self;return e._delta<=0?0:1/e._delta}static get _self(){return this._instance??(this._instance=new this)}_update(){const e=performance.now()-this._startTime;this._frameCount++,this._delta=(e-this._lastFrameTime)/1e3;const t=e/1e3;this._averageFPS=0===t?0:this._frameCount/t,this._lastFrameTime=e}_restart(){this._startTime=performance.now(),this._lastFrameTime=0,this._frameCount=0,this._delta=0,this._averageFPS=0}}u._instance=null;class d{constructor(){this._time=null,this._keyboard=null,this._mouse=null,this._canvas=null,this._scene=null,this._width=0,this._height=0,d._ensureLaunched()}static get focused(){return document.activeElement===this._self._canvas}static get canvas(){return this._self._canvas}static get scene(){return this._self._scene}static set scene(e){this._self._scene=e}static get width(){return this._self._width}static get screenWidth(){return this._self._canvas.width}static get height(){return this._self._height}static get screenHeight(){return this._self._canvas.height}static launch(e){this._ensureNotLaunched(),this._launched=!0,this._self._launch(e)}static get _self(){return this._instance??(this._instance=new this)}static _ensureNotLaunched(){if(this._launched)throw new Error("Game has already been launched")}static _ensureLaunched(){if(!this._launched)throw new Error("Game has not been launched")}_launch(e){this._scene=e.scene,this._canvas=e.canvas,this._width=e.width??800,this._height=e.height??600,this._initialize(),this._start()}_initialize(){this._initializeCanvas(),this._time=u._self,this._keyboard=r._self,this._mouse=o._self}_initializeCanvas(){this._resizeCanvas(),new ResizeObserver((()=>this._resizeCanvas())).observe(this._canvas.parentElement),this._canvas.tabIndex=0,this._canvas.oncontextmenu=()=>!1,this._canvas.focus()}_start(){this._scene._initialize().then((()=>this._frame()))}_update(){const e=this._scene;return this._time._update(),this._keyboard._update(),this._mouse._update(),e.update(),this._nextFrame(e)}_nextFrame(e){return this._scene===e?this._frame():(e.stop(),this._scene._initialize().then((()=>(this._time._restart(),this._frame()))))}_frame(){return new Promise((e=>requestAnimationFrame((()=>this._update().then(e)))))}_resizeCanvas(){const{width:e,height:t}=this._canvas.parentElement.getBoundingClientRect();this._canvas.width=e,this._canvas.height=t}}d._instance=null,d._launched=!1;class _{constructor(){this._initialized=!1}async _initialize(){return this._initialized||(this._initialized=!0,await this.initialize()),this.start()}}var l=a.pM,c=a.dw,p=a.lZ,y=a.Zt,m=a.Uz,w=a.s3,f=a.KK,g=a.w3,K=a.Z5,F=a.gX;export{l as Collection,c as Duration,p as DurationUnit,y as Game,m as Key,w as Keyboard,f as Mouse,g as MouseButton,K as Scene,F as Time};